"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[445],{5445:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var i=a(4319);var o=a(1203),r=a(113),l=a(5108);const n={data:function(){return{group:"",updateError:{},updateLoading:!1,updateSiteConfigVisible:!1,groupTreeData:[],loading:!1,createLoading:!1,createError:{},createSiteConfigVisible:!1,group_options:[],siteTemplateData:[],filter:{keywords:""},uploadData:{},headers:{},imageUrlPreview:"",editImageUrlPreview:"",action:"",typeArr:[{value:"string",label:"字符串"},{value:"file",label:"文件"},{value:"select",label:"模板选择"}],createSiteConfigForm:{name:"",key:"",value:"",group:"",type:"string"},updateSiteConfigForm:{id:"",name:"",key:"",value:"",group:"",type:""},tableData:[]}},created:function(){this.getSiteTemplate(),this.getSiteConfig(),this.getSiteConfigGroup(),this.setAction(),this.setHeader()},methods:{getSiteTemplate:function(){var e=this;(0,i.Z)({url:"/WebNav/siteTemplate/",method:"get"}).then((function(t){e.siteTemplateData=t.data.data,l.log(t)}))},setAction:function(){this.action=(0,o.Vy)()+"/WebNav/file/upload"},setHeader:function(){this.headers={Authorization:"Bearer "+(0,r.LP)()}},successUpload:function(e,t,a){this.imageUrlPreview=(0,o.UO)()+e.data.path,this.createSiteConfigForm.value=e.data.path},beforeUpload:function(e){this.uploadData.directory="/system_file",this.uploadData.name=e.name},successUploadEdit:function(e,t,a){this.editImageUrlPreview=(0,o.UO)()+e.data.path,this.updateSiteConfigForm.value=e.data.path},beforeUploadEdit:function(e){this.uploadData.directory="/system_file",this.uploadData.name=e.name},handleEdit:function(e){var t,a=this;(t=e.id,(0,i.Z)({url:"/WebNav/config/"+t,method:"get"})).then((function(e){a.updateSiteConfigForm.id=e.data.id,a.updateSiteConfigForm.name=e.data.name,a.updateSiteConfigForm.key=e.data.key,a.updateSiteConfigForm.value=e.data.value,a.updateSiteConfigForm.type=e.data.type,a.updateSiteConfigForm.group=e.data.group,a.updateSiteConfigVisible=!0,"file"==e.data.type&&(a.editImageUrlPreview=(0,o.UO)()+e.data.value)}))},selectGroup:function(e){"全部"==e.group?this.group="":this.group=e.group,this.getSiteConfig()},updateSiteConfig:function(){var e,t,a=this;this.updateError={},this.updateLoading=!0,(e=this.updateSiteConfigForm.id,t=this.updateSiteConfigForm,(0,i.Z)({url:"/WebNav/config/"+e,method:"put",data:t})).then((function(e){a.$message({message:e.message,type:"success"}),a.updateSiteConfigVisible=!1,a.getSiteConfig()})).catch((function(e){var t=e.data;422===e.code&&(a.updateError=t)})).finally((function(){a.updateLoading=!1}))},getSiteConfigGroup:function(){var e,t=this;(0,i.Z)({url:"/WebNav/config/group",method:"get",params:e}).then((function(e){var a=e.data;t.groupTreeData=JSON.parse(JSON.stringify(a.group)),t.group_options=JSON.parse(JSON.stringify(a.group)),t.groupTreeData.unshift({group:"全部"})}))},setChanceData:function(e){},getSiteConfig:function(){var e=this;this.loading=!0;var t,a={group:this.group};(t=a,(0,i.Z)({url:"/WebNav/config",method:"get",params:t})).then((function(t){var a=t.data;e.loading=!1,e.tableData=JSON.parse(JSON.stringify(a.config))})).catch((function(t){e.loading=!1,e.tableData=[],e.total=0}))},resetCreateForm:function(e){this.$refs[e].resetFields()},createSiteConfig:function(e){var t,a=this;this.createLoading=!0,this.createError={},(t=this.createSiteConfigForm,(0,i.Z)({url:"/WebNav/config",method:"post",data:t})).then((function(t){a.$message({message:t.message,type:"success"}),a.resetCreateForm(e),a.getSiteConfig(),a.createSiteConfigVisible=!1})).catch((function(e){422===e.code&&(a.createError=e.data)})).finally((function(){a.createLoading=!1}))}}};const s=(0,a(1900).Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content_container"},[a("div",{staticClass:"container material-box",staticStyle:{"padding-top":"0","padding-bottom":"0"}},[a("div",{staticClass:"header_container is-sticky-top"},[a("div",{staticClass:"left"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.createSiteConfigVisible=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n                ")])],1),e._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"filter"},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入关键字"},model:{value:e.filter.keywords,callback:function(t){e.$set(e.filter,"keywords",t)},expression:"filter.keywords"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"}},[a("i",{staticClass:"el-icon-search"})])],1)],1)],1)])]),e._v(" "),a("div",{staticClass:"material-content"},[a("div",{staticClass:"material-left"},[a("div",{staticClass:"material-group"},[a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[e._v("分组")]),e._v(" "),a("el-button",{attrs:{type:"text"}})],1),e._v(" "),a("div",{staticClass:"group-tree"},[a("el-scrollbar",[a("el-tree",{attrs:{data:e.groupTreeData,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"highlight-current":!0},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var i=t.data;return a("span",{staticClass:"custom-tree-node",on:{click:function(t){return e.selectGroup(i)}}},[a("i",{staticClass:"el-icon-folder"}),e._v(" "),a("span",{staticClass:"node-name"},[e._v(e._s(i.group))])])}}])})],1)],1)])]),e._v(" "),a("div",{staticClass:"material-right"},[a("div",{staticClass:"material_list"},[a("el-scrollbar",[a("div",{staticClass:"scrollbar-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,"min-width":"15%",label:"配置名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"key","show-overflow-tooltip":!0,"min-width":"15%",label:"键",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"value","show-overflow-tooltip":!0,"min-width":"15%",label:"值"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type","show-overflow-tooltip":!0,"min-width":"15%",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(a){return e.handleEdit(t.row)}}},[a("i",{staticClass:"el-icon-edit"})])]}}])})],1)],1)])],1)])])]),e._v(" "),a("el-dialog",{attrs:{"custom-class":"dialog_tc",title:"创建",visible:e.createSiteConfigVisible,width:"560px","close-on-click-modal":!1},on:{"update:visible":function(t){e.createSiteConfigVisible=t}}},[a("el-form",{ref:"createForm",attrs:{model:e.createSiteConfigForm,"label-width":"80px",size:"medium"}},[a("el-form-item",{attrs:{prop:"group",label:"名称",required:"",error:e.createError.group?e.createError.group[0]:""}},[a("el-select",{attrs:{placeholder:"请选择分组"},model:{value:e.createSiteConfigForm.group,callback:function(t){e.$set(e.createSiteConfigForm,"group",t)},expression:"createSiteConfigForm.group"}},e._l(e.group_options,(function(e){return a("el-option",{key:e.group,attrs:{label:e.group,value:e.group}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"名称",required:"",error:e.createError.name?e.createError.name[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:e.createSiteConfigForm.name,callback:function(t){e.$set(e.createSiteConfigForm,"name",t)},expression:"createSiteConfigForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"key",label:"键名",required:"",error:e.createError.key?e.createError.key[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入键名，添加之后不可修改"},model:{value:e.createSiteConfigForm.key,callback:function(t){e.$set(e.createSiteConfigForm,"key",t)},expression:"createSiteConfigForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",required:""}},[a("el-select",{attrs:{placeholder:"请选择类型"},on:{change:function(t){return e.setChanceData(e.createSiteConfigForm.type)}},model:{value:e.createSiteConfigForm.type,callback:function(t){e.$set(e.createSiteConfigForm,"type",t)},expression:"createSiteConfigForm.type"}},e._l(e.typeArr,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),"file"==e.createSiteConfigForm.type?a("el-form-item",{staticClass:"upload_thumb",attrs:{label:"文件",prop:"value"}},[a("el-upload",{staticClass:"uploadThumbImg",attrs:{headers:e.headers,action:e.action,"show-file-list":!1,"on-success":e.successUpload,"before-upload":e.beforeUpload,data:e.uploadData}},[e.createSiteConfigForm.value?a("img",{staticClass:"thumb",attrs:{src:e.imageUrlPreview}}):a("i",{staticClass:"el-icon-plus"})])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{prop:"value",label:"值",error:e.createError.value?e.createError.value[0]:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入值"},model:{value:e.createSiteConfigForm.value,callback:function(t){e.$set(e.createSiteConfigForm,"value",t)},expression:"createSiteConfigForm.value"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createSiteConfigVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.createLoading},on:{click:function(t){return e.createSiteConfig("createForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{"custom-class":"dialog_tc",title:"编辑",visible:e.updateSiteConfigVisible,width:"560px","close-on-click-modal":!1},on:{"update:visible":function(t){e.updateSiteConfigVisible=t}}},[a("el-form",{ref:"updateForm",attrs:{model:e.updateSiteConfigForm,"label-width":"80px",size:"medium"}},[a("el-form-item",{attrs:{prop:"group",label:"分组",required:"",error:e.updateError.group?e.updateError.group[0]:""}},[a("el-select",{attrs:{placeholder:"请选择分组"},model:{value:e.updateSiteConfigForm.group,callback:function(t){e.$set(e.updateSiteConfigForm,"group",t)},expression:"updateSiteConfigForm.group"}},e._l(e.group_options,(function(e){return a("el-option",{key:e.group,attrs:{label:e.group,value:e.group}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"name",label:"名称",required:"",error:e.updateError.name?e.updateError.name[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:e.updateSiteConfigForm.name,callback:function(t){e.$set(e.updateSiteConfigForm,"name",t)},expression:"updateSiteConfigForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"key",label:"键名",required:"",error:e.updateError.key?e.updateError.key[0]:""}},[a("el-input",{attrs:{type:"text",placeholder:"请输入键名，添加之后不可修改"},model:{value:e.updateSiteConfigForm.key,callback:function(t){e.$set(e.updateSiteConfigForm,"key",t)},expression:"updateSiteConfigForm.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",required:""}},[a("el-select",{attrs:{placeholder:"请选择类型"},on:{change:function(t){return e.setChanceData(e.updateSiteConfigForm.type)}},model:{value:e.updateSiteConfigForm.type,callback:function(t){e.$set(e.updateSiteConfigForm,"type",t)},expression:"updateSiteConfigForm.type"}},e._l(e.typeArr,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),"file"==e.updateSiteConfigForm.type?a("el-form-item",{staticClass:"upload_thumb",attrs:{label:"文件",prop:"value"}},[a("el-upload",{staticClass:"uploadThumbImg",attrs:{headers:e.headers,action:e.action,"show-file-list":!1,"on-success":e.successUploadEdit,"before-upload":e.beforeUploadEdit,data:e.uploadData}},[e.editImageUrlPreview?a("img",{staticClass:"thumb",attrs:{src:e.editImageUrlPreview}}):a("i",{staticClass:"el-icon-plus"})])],1):e._e(),e._v(" "),"select"==e.updateSiteConfigForm.type?a("el-form-item",{attrs:{label:"值",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.updateSiteConfigForm.value,callback:function(t){e.$set(e.updateSiteConfigForm,"value",t)},expression:"updateSiteConfigForm.value"}},e._l(e.siteTemplateData,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):a("el-form-item",{attrs:{prop:"value",label:"值",error:e.updateError.value?e.updateError.value[0]:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入值"},model:{value:e.updateSiteConfigForm.value,callback:function(t){e.$set(e.updateSiteConfigForm,"value",t)},expression:"updateSiteConfigForm.value"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateSiteConfigVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.updateLoading},on:{click:function(t){return e.updateSiteConfig("updateForm")}}},[e._v("保存")])],1)],1)],1)}),[],!1,null,null,null).exports}}]);